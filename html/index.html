<!DOCTYPE html>
<html lang="en">

<head>
	<title>Portail Captif de Marcelin</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="captiveportal-jquery.min.js"></script>
	<script src="captiveportal-bootstrap.min.js"></script>
	<link href="captiveportal-bootstrap.min.css" rel="stylesheet">
	<script src="captiveportal-qrcode.min.js"></script>
  <link href="captiveportal-custom-style.css" rel="stylesheet">

	</script>

	<script src="captiveportal-tweenlite.min.js"></script>
</head>

<body>
	<div class="container">
		<div class="col-md-6 col-md-offset-3">
			<div class="row vertical-offset-100">
				<div class="panel panel-default panel-help">
					<!-- Help button on border -->
					<button type="button"
							class="btn btn-link help-btn"
							data-toggle="modal"
							data-target="#tchango"
							id="LblClignotant">
						<img src="captiveportal-help.png" width="32" height="32" alt="Aide">
					</button>
					<div class="panel-heading">
						<h3 class="panel-title" align="center">
							<b>ðŸ”’ Accord d'acc&egrave;s au r&eacute;seau de Marcelin</b>
						</h3>
						
					</div>
					<div class="panel-body">
						<form id="loginForm" method="post" action="$PORTAL_ACTION$" accept-charset="UTF-8" role="form">
							<input type="hidden" name="auth_user" id="hiddenQrUsername">

							<fieldset>
								<p style="line-height:25px;" align="justify">Vous Ãªtes responsable de la s&eacute;curit&eacute; lors de l' utilisation de ce portail. L'utilisation de ce portail pour ce qui suit est strictement interdite:
								</p>
								<ul>
									<li style="line-height:25px;">Causer une brÃ¨che de s&eacute;curit&eacute; sur le portail</li>

									<li style="line-height:25px;">Causer une interruption de services sur ce portail ou sur d' autres r&eacute;seaux Ã  partir de ce portail...</li>
									<li>L'exportation ou importation des logiciels, des informations techniques et/ou des logiciels de chiffrement.
									</li>
								</ul>
                  				<p class="small-note">Toute tentative de violation de cet accord peut entraÃ®ner des poursuites judiciaires.</p>

								<div class="form-check">
									<input type="checkbox" class="form-check-input" id="acceptConditions">
									<label class="form-check-label" for="acceptConditions">J'accepte les termes et conditions d'utilisation</label>
								</div>
								<br>

								<div id="block-login">

									<div class="qr" id="block-qr">
										<strong>Connexion par QR Code</strong>
										<p>Scannez un code Qr pour l'accÃ¨s</p>
										<div id="reader"></div>
										<div id="result"></div>
										<br>
									</div>

									<div class="form-check">
									<input type="checkbox" class="form-check-input" id="connexionstandard">
									<label class="form-check-label" for="connexionstandard">Connexion par la mÃ©thode standard</label>
									</div>
									<br>
									
									<div class="qr" id="block-connexionstandard">
										<p>Saisissez votre login et password</p>
										<div class="form-group">
											<input name="auth_user" type="text" placeholder="ðŸ‘¤ Nom d'utilisateur" class="form-control">
										</div>
										<div class="form-group">
											<input name="auth_pass" type="password" placeholder="ðŸ”‘ Mot de passe" class="form-control">
										</div>
									</div>

									<input name="auth_voucher" type="hidden">
									
									<input class="btn btn-lg btn-success btn-block" name="accept" type="submit" value="Connexion">
									<input name="redirurl" type="hidden" value="$PORTAL_REDIRURL$">
								</div>
								
							</fieldset>
						</form>	

						<!--Modal content-->
						<div class="modal fade" id="tchango" role="dialog">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal">&times;</button>
										<h3 class="panel-title" align="center">
											<b>Comment se connecter au r&eacute;seau de Marcelin : how to?</b>
										</h3>
										<br>
								</div>
							</div>
						</div>	
					</div>
				</div>
			</div>
		</div>
	</div>

	<script>
		$(document).ready(function () {

			// Reset checkboxes
			$("#acceptConditions, #connexionstandard").prop("checked", false);

			// Accept conditions â†’ show login block
			$("#acceptConditions").on("change", function () {
				if (this.checked) {
					$("#block-login").slideDown();
					$("#block-qr").slideDown(); // show QR by default
				} else {
					$("#block-login").slideUp();
					$("#block-connexionstandard").slideUp();
					$("#block-qr").slideUp();
					$("#connexionstandard").prop("checked", false);
				}
			});

			// Standard login checkbox â†’ toggle QR & standard form
			$("#connexionstandard").on("change", function () {
				if (this.checked) {
					$("#block-connexionstandard").slideDown();
					$("#block-qr").slideUp();   // ðŸ”´ hide QR
				} else {
					$("#block-connexionstandard").slideUp();
					$("#block-qr").slideDown(); // ðŸŸ¢ show QR again
				}
			});

		});
	</script>

	<script>
		function onScanSuccess(decodedText, decodedResult) {
			document.getElementById('result').innerText = `âœ… Code Qr scannÃ©`;
			document.querySelector("input[name='auth_voucher']").value = decodedText;
			html5QrcodeScanner.clear();
		}

		function onScanError(errorMessage) {
			console.warn(`QR Scan Error: ${errorMessage}`);
		}

		const html5QrcodeScanner = new Html5QrcodeScanner(
			"reader",
			{ fps: 10, qrbox: 250 }
		);
		html5QrcodeScanner.render(onScanSuccess, onScanError);
	</script>

</body>
</html>